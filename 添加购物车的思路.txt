第一步:
首先，答案是：应该把数据存到cookie中，但是同时我们也需要存到数据库中

其实存放购物车里面的数据有3种常用途径 cookie、数据库、session

把购物车中的数据存到cookie和存到session有什么区别呢？

存seesion:如果存到session中，浏览器一关，session没了，下次打开浏览器就看不到购物车里的记录了

有同学会说：把session持久化嘛

可以的，但是这要耗费我们的服务端资源，因为session是存到服务端的

存cookie：cookie是存到客户端、浏览器端的，本文来自童攀课堂重要的是cookie可以轻松设置有效期和过期时间，而且不占用服务端资源。如果你愿意，你可以把购物车

中的数据存放任意长的时间，只要下次你还通过改浏览器打开，那么购物车记录就还在，非常方便合理。

那么同时，我们有时候还要把购物车中的数据从cookie中转移到数据库中，为啥呢？

设想一下这种情况：你在公司里偷偷逛了一下淘宝，看到几个不错的商品加入了购物车，打算回家的时候再购买

如果购物记录只是存到了公司浏览器里面的cookie中，你回家不是又要重新挑选商品了？

所以，应该有这样的一种情况，如果你在登录的时候把商品加入了购物车，或者你把商品加入购物车后登录了，那么这个时候

就应该把购物车中的记录存到数据库，因为你已经登录了，所以很容易记录购物信息和用户的对应关系，这样你下一次再回家打开购物网站的时候就可以

从数据库中读取到你的购物车了，提升了用户体验



第二部:
在教学过程中发现不少学员对购物车好像有点担心，担心难度太大做不出来，实际上大家多虑了

实际上有些难度的应该是购物流程，而不是购物车，当然，购物车本身是购物流程中重要的一项，但是购物车本身一点也不复杂。

说一句大白话：购物车实际上本质就是，点击加入购物车的时候把该商品的数据写入的cookie中，读取购物车的时候就是把cookie中的数据再拿出来，仅此而已。

其实购物流程也谈不上有多难，觉得难是因为你没有动手实战过，购物流程的逻辑也比较简单，说白了就两步：下单和支付

当然其中有一些细节还是要注意的，下单的时候把订单信息（商品和用户）写入订单表，支付的时候对接一下接口，支付成功之后减去响应的库存量，小小事啦~

希望大家在还没做一个功能之前先不要被这个功能的名字吓到，因为你不去做就不知道它有多简单。




第三部:
在php写购物车的时候数据保存到哪里一文中，我们详细的分析了加入购物车的时候将数据存放到cookie中的原因

本文我们来说说，我们应该以怎样的数据结构把购物记录存到cookie中

加入购物车的数据怎么存放到cookie中

看起来非常数据结构并不特别简单，有商品缩略图、标题、属性(暂不考虑)、价格、数量等而且是多个商品

一般我们会自然想到把数据组装为一个二维数组，但是数组是不能写入cookie的，没关系，我们可以先组装为数组，然后对这个数组进行序列化，不就可以写入cookie了。

[php]
$goodsArr=[
‘1(商品id)’=>[
‘goods_name’=>’上衣’,
‘price’=>100,
‘thumb’=>’http://tongpankt.com/logo.png’,
‘num’=>10
],
‘2(商品id)’=>[
‘goods_name’=>’上衣’,
‘price’=>200,
‘thumb’=>’http://tongpankt.com/logo.jpg’,
‘num’=>20
],
];
[/php]

 

这个思路整体是没有问题的，但是逻辑细节有点小问题。

比如一个商品，它的标题、缩略图、和价格并不是固定不变的，比如遇到了节日或者是店铺活动我们要修改商品价格的，那如果你已经把价格写入了cookie他是没有办法动态改变的，所以我们根本不用保存那么复杂的数据格式，我们只需要保存一个以为数组就可以了：

[php]
$goodsArr=[
‘商品id’=>’商品数量’,
‘1’=>’10’,
‘2’=>’20’,
];
[/php]

其他诸如图片、标题、价格，之类的可能会发生改变的数据我们读取的时候先反序列化cookie数据，得到商品id和数量，根据商品id动态获取就可以了。